/**
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

(function(p,f){"function"===typeof define&&define.amd?define([],f):"object"===typeof module&&module.exports?module.exports=f():p.picoModal=f()})(this,function(){function p(a){return"object"===typeof Node?a instanceof Node:a&&"object"===typeof a&&"number"===typeof a.nodeType}function f(){var a=[];return{watch:a.push.bind(a),trigger:function(b,c){for(var g=!0,d={detail:c,preventDefault:function(){g=!1}},r=0;r<a.length;r++)a[r](b,d);return g}}}function e(a){this.elem=a}function z(a,b){return e.make(a("parent")).clazz("pico-overlay").clazz(a("overlayClass",
"")).stylize({display:"none",position:"fixed",top:"0px",left:"0px",height:"100%",width:"100%",zIndex:1E4}).stylize(a("overlayStyles",{opacity:.5,background:"#000"})).onClick(function(){a("overlayClose",!0)&&b()})}function A(a,b){var c=a("width","auto");"number"===typeof c&&(c=""+c+"px");var g=a("modalId","pico-"+B++);return e.make(a("parent")).clazz("pico-content").clazz(a("modalClass","")).stylize({display:"none",position:"fixed",zIndex:10001,left:"50%",top:"38.1966%",maxHeight:"90%",boxSizing:"border-box",
width:c,"-ms-transform":"translate(-50%,-38.1966%)","-moz-transform":"translate(-50%,-38.1966%)","-webkit-transform":"translate(-50%,-38.1966%)","-o-transform":"translate(-50%,-38.1966%)",transform:"translate(-50%,-38.1966%)"}).stylize(a("modalStyles",{overflow:"auto",backgroundColor:"white",padding:"20px",borderRadius:"5px"})).html(a("content")).attr("id",g).attr("role","dialog").attr("aria-labelledby",a("ariaLabelledBy")).attr("aria-describedby",a("ariaDescribedBy",g)).onClick(function(a){(new e(a.target)).anyAncestor(function(a){return/\bpico-close\b/.test(a.elem.className)})&&
b()})}function t(a){return function(){return a().elem}}function C(a,b){function c(a){return"none"===window.getComputedStyle(a).display||(a.msMatchesSelector||a.webkitMatchesSelector||a.matches).call(a,":disabled")||a.hasAttribute("contenteditable")?!1:a.hasAttribute("tabindex")||(a.msMatchesSelector||a.webkitMatchesSelector||a.matches).call(a,"input,select,textarea,button,a[href],area[href],iframe")}function g(a){a=a.getElementsByTagName("*");for(var b=0;b<a.length;b++)if(c(a[b]))return a[b]}var d;
a.beforeShow(function(){d=document.activeElement});a.afterShow(function(){if(b()){var c=g(a.modalElem());c&&c.focus()}});a.afterClose(function(){b()&&d&&d.focus();d=null});m.watch(function(d){if(b()&&a.isVisible()){var f=g(a.modalElem());a:{var k=a.modalElem().getElementsByTagName("*");for(var e=k.length;e--;)if(c(k[e])){k=k[e];break a}k=void 0}(d.shiftKey?f:k)===document.activeElement&&((d.shiftKey?k:f).focus(),d.preventDefault())}})}function D(a,b){var c,g=new e(document.body);a.beforeShow(function(){c=
g.elem.style.overflow;b()&&g.stylize({overflow:"hidden"})});a.afterClose(function(){g.stylize({overflow:c})})}e.make=function(a,b){"string"===typeof a&&(a=document.querySelector(a));var c=document.createElement(b||"div");(a||document.body).appendChild(c);return new e(c)};e.prototype={child:function(a){return e.make(this.elem,a)},stylize:function(a){a=a||{};"undefined"!==typeof a.opacity&&(a.filter="alpha(opacity="+100*a.opacity+")");for(var b in a)a.hasOwnProperty(b)&&(this.elem.style[b]=a[b]);return this},
clazz:function(a){this.elem.className+=" "+a;return this},html:function(a){p(a)?this.elem.appendChild(a):this.elem.innerHTML=a;return this},onClick:function(a){this.elem.addEventListener("click",a);return this},destroy:function(){this.elem.parentNode.removeChild(this.elem)},hide:function(){this.elem.style.display="none"},show:function(){this.elem.style.display="block"},attr:function(a,b){void 0!==b&&this.elem.setAttribute(a,b);return this},anyAncestor:function(a){for(var b=this.elem;b;){if(a(new e(b)))return!0;
b=b.parentNode}return!1},isVisible:function(){return"none"!==window.getComputedStyle(this.elem).display}};var B=1,w=f(),m=f();document.documentElement.addEventListener("keydown",function(a){var b=a.which||a.keyCode;27===b?w.trigger():9===b&&m.trigger(a)});return function(a){function b(b,c){var d=a[b];"function"===typeof d&&(d=d(c));return void 0===d?c:d}function c(a){n().hide();l().hide();x.trigger(h,a)}function g(a){y.trigger(h,a)&&c(a)}function d(a){return function(){a.apply(this,arguments);return h}}
function e(a,d){if(!q){var c=A(b,g),e=z(b,g);var f=b("closeButton",!0)?c.child("button").html(b("closeHtml","&#xD7;")).clazz("pico-close").clazz(b("closeClass","")).stylize(b("closeStyles",{borderRadius:"2px",border:0,padding:0,cursor:"pointer",height:"15px",width:"15px",position:"absolute",top:"5px",right:"5px",fontSize:"16px",textAlign:"center",lineHeight:"15px",background:"#CCC"})).attr("aria-label",b("close-label","Close")):void 0;q={modal:c,overlay:e,close:f};m.trigger(h,d)}return q[a]}if("string"===
typeof a||p(a))a={content:a};var m=f(),k=f(),v=f(),y=f(),x=f(),l=e.bind(window,"modal"),n=e.bind(window,"overlay"),u=e.bind(window,"close"),q;var h={modalElem:t(l),closeElem:t(u),overlayElem:t(n),buildDom:d(e.bind(null,null)),isVisible:function(){return!!(q&&l&&l().isVisible())},show:function(a){k.trigger(h,a)&&(n().show(),u(),l().show(),v.trigger(h,a));return this},close:d(g),forceClose:d(c),destroy:function(){l().destroy();n().destroy();n=l=u=void 0},options:function(b){Object.keys(b).map(function(c){a[c]=
b[c]})},afterCreate:d(m.watch),beforeShow:d(k.watch),afterShow:d(v.watch),beforeClose:d(y.watch),afterClose:d(x.watch)};C(h,b.bind(null,"focus",!0));D(h,b.bind(null,"bodyOverflow",!0));w.watch(function(){b("escCloses",!0)&&h.isVisible()&&h.close()});return h}});
